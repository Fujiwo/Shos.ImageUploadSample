@model List<Image>
@{
    ViewData["Title"] = "Upload Image";

    var imageViewModels = Model.Select((image, index) => new {
        Id              = index + 1,
        AlternativeText = $"{image.Description} ({image.MimeType})",
        Source          = $"data:{image.MimeType};base64,{Convert.ToBase64String(image.Data)}",
        Width           = image.Width,
        Height          = image.Height,
        ThumbnailSource = $"data:image/png;base64,{Convert.ToBase64String(image.ThumbnailData)}",
        ThumbnailWidth  = image.ThumbnailWidth,
        ThumbnailHeight = image.ThumbnailHeight
    }).ToList();
}

<h2>@ViewData["Title"]</h2>

<div>
    <hr>
    <div class="row">
        @foreach (var imageViewModel in imageViewModels) {
            <div class="col-md-1">
                <a href="#image@(imageViewModel.Id)" class="thumbnail">
                    <img src="@imageViewModel.ThumbnailSource" width="@(imageViewModel.ThumbnailWidth)" height="@(imageViewModel.ThumbnailHeight)" alt="@imageViewModel.AlternativeText" class="img-thumbnail" />
                </a>
            </div>
        }
    </div>
    <hr>
    <div>
        @foreach (var imageViewModel in imageViewModels) {
            <div id="image@(imageViewModel.Id)">
                <figure class="figure">
                    <img src="@(imageViewModel.Source)" width="@(imageViewModel.Width)" height="@(imageViewModel.Height)" alt="@(imageViewModel.AlternativeText)" class="card-img-top" />
                    <figcaption class="figure-caption">@imageViewModel.AlternativeText</figcaption>
                </figure>
            </div>
        }
    </div>
    <hr>
</div>

<form method="post" enctype="multipart/form-data">
    <div class="form-group">
        <label for="file" class="form-label">Choose Image</label>
        <input type="file" name="file" class="form-control">
        <input type="text" name="description" class="form-control">
    </div>
    <button type="submit" class="btn btn-primary">Upload</button>
</form>
